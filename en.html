<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Deposit Checkout</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
    <script src="https://www.google.com/recaptcha/enterprise.js?render=6LeFH-grAAAAAO7A1bULu8X4s86HHts4BgWlf9nJ"></script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: #f6f9fc; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; padding: 20px; color: #333; }
        .checkout-container { display: flex; width: 100%; max-width: 900px; background-color: #fff; border-radius: 8px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); overflow: hidden; }
        .payment-details { flex: 6; padding: 40px; }
        .payment-header { margin-bottom: 30px; }
        .payment-header .company-name { font-size: 1rem; color: #6b7c93; }
        .payment-header .amount { font-size: 2rem; font-weight: 700; color: #333; margin-top: 5px; }
        .interac-btn { width: 100%; padding: 14px; background-color: #000; color: #fff; border: 1px solid #000; border-radius: 6px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: background-color 0.2s; display: flex; justify-content: center; align-items: center; gap: 10px; text-decoration: none; box-sizing: border-box; }
        .interac-btn:hover { background-color: #333; }
        .separator { display: flex; align-items: center; text-align: center; color: #888; margin: 25px 0; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 0.5px; }
        .separator::before, .separator::after { content: ''; flex: 1; border-bottom: 1px solid #e6ebf1; }
        .separator-text { padding: 0 10px; }
        .contact-form-container { border: 1px solid #ccc; border-radius: 8px; overflow: hidden; position: relative; transition: border-color 0.2s, box-shadow 0.2s; }
        .contact-form-container:focus-within { border-color: #000; box-shadow: 0 0 0 1px #000; }
        .form-group { position: relative; border-bottom: 1px solid #ccc; }
        .form-group:last-child { border-bottom: none; }
        .form-group .form-control { width: 100%; padding: 18px 45px 6px 45px; font-size: 1rem; box-sizing: border-box; background: none; border: none; outline: none; }
        .form-group .icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #888; pointer-events: none; }
        .form-group .placeholder-label { position: absolute; left: 45px; top: 50%; transform: translateY(-50%); color: #888; font-size: 1rem; pointer-events: none; transition: all 0.2s ease-out; }
        .form-control:focus + .placeholder-label, .form-control:not(:placeholder-shown) + .placeholder-label { top: 10px; font-size: 0.75rem; color: #555; }
        .iti { width: 100%; }
        #phone.form-control { padding: 12px 15px 12px 58px; }
        .tooltip-text { visibility: hidden; opacity: 0; background-color: #333; color: #fff; text-align: center; border-radius: 6px; padding: 5px 10px; position: absolute; z-index: 10; bottom: 125%; left: 50%; margin-left: -60px; transition: opacity 0.2s; font-size: 0.8rem; width: max-content; }
        .tooltip-text::after { content: ""; position: absolute; top: 100%; left: 50%; margin-left: -5px; border-width: 5px; border-style: solid; border-color: #333 transparent transparent transparent; }
        .form-group.show-tooltip .tooltip-text { visibility: visible; opacity: 1; }
        .contact-form-container.invalid { border-color: #d92d20; }
        .form-group .error-icon { display: none; position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: #d92d20; }
        .form-group.invalid .error-icon { display: block; }
        .error-message { color: #d92d20; font-size: 0.875rem; margin-top: 8px; height: 20px; }
        .submit-btn { width: 100%; padding: 14px; background-color: #000000; color: white; border: none; border-radius: 6px; font-size: 1rem; font-weight: bold; cursor: pointer; transition: background-color 0.2s; margin-top: 20px; box-sizing: border-box; }
        .submit-btn:hover { background-color: #2d2d2d; }
        .footer-text { text-align: center; font-size: 0.8rem; color: #888; margin-top: 20px; }
        .country-text { text-align: left; font-size: 0.8rem; color: #888; margin-top: 10px; }
        .order-summary { flex: 4; background-color: #f6f9fc; padding: 40px; border-left: 1px solid #e6ebf1; }
        .order-item, .order-total { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 1rem; }
        .order-total { border-top: 1px solid #e6ebf1; padding-top: 15px; margin-top: 15px; font-weight: 700; }
        .language-selector { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); text-align: center; } /* <-- MODIFIED CLASS */
        .language-selector a { color: black; text-decoration: none; padding: 0 5px; } /* <-- MODIFIED CLASS */
        .language-selector a.active { text-decoration: underline; } /* <-- MODIFIED CLASS */
        @media (max-width: 768px) {
            .checkout-container { flex-direction: column-reverse; }
            .payment-details, .order-summary { padding: 25px; }
        }
    </style>
</head>
<body>
        <div class="language-selector"> <a href="#" class="active">English</a><a href="fr">Français</a>
        </div>
    <div class="checkout-container">
        <div class="payment-details">
            <div class="payment-header">
                <div class="company-name">Security Deposit</div>
                <div class="amount">Pay CA$500</div>
            </div>

            <a href="interac-e-transfer.html" class="interac-btn">
                 <img src="https://upload.wikimedia.org/wikipedia/commons/9/92/Interac_Brand_2021.png" width="25" height="25">
                 E-Transfer
            </a>

            <div class="separator">
                <span class="separator-text">Or pay with card</span>
            </div>
            
            <form id="payment-form">
                <p style="font-size: 1.1rem; font-weight: 600; margin-top:0; margin-bottom: 15px;">Contact details</p>
                
                <div class="contact-form-container" id="contact-form-container">
                    <div class="form-group">
                        <span class="tooltip-text">Enter an email address</span>
                        <span class="icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                        </span>
                        <input type="email" id="email" class="form-control" placeholder=" " required>
                        <label for="email" class="placeholder-label">email@example.com</label>
                        <span class="error-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                        </span>
                    </div>
                    <div class="form-group">
                         <span class="tooltip-text">Enter your full name</span>
                        <span class="icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                        </span>
                        <input type="text" id="full-name" class="form-control" placeholder=" " required>
                        <label for="full-name" class="placeholder-label">Full name</label>
                        <span class="error-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                        </span>
                    </div>
                    <div class="form-group">
                        <span class="tooltip-text">Enter a valid phone number</span>
                        <input type="tel" id="phone" class="form-control" required>
                        <span class="error-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                        </span>
                    </div>
                </div>
                <p class="country-text">
                    You must enter your country code.
                </p>

                <div id="error-message" class="error-message"></div>

                <button id="submit" class="submit-btn">Pay</button>
                <p class="footer-text">
                    Propulsé par <strong>AWS</strong>
                </p>
            </form>
        </div>

        <div class="order-summary">
            <div class="order-item">
                <span>You will be fully refunded 5 days after your stay, after an inspection is complete.<br><br><a href="https://lamaisonblanche.ca/terms-depot" style="text-decoration: underline; color: black;">Deposit Conditions</a><br><br>La Maison Blanche<br>info@lamaisonblanche.ca<br>(514) 994-2080</span>
            </div>
            <div class="order-total">
                <span>Total</span>
                <span>CA$500.00</span>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('payment-form');
            const emailField = document.getElementById('email');
            const nameField = document.getElementById('full-name');
            const phoneInputField = document.querySelector("#phone");
            const formContainer = document.getElementById('contact-form-container');
            const errorMessage = document.getElementById('error-message');
            const allFields = [emailField, nameField, phoneInputField];
            const phoneInput = window.intlTelInput(phoneInputField, {
                initialCountry: "auto",
                geoIpLookup: function(callback) {
                    fetch("https://ipapi.co/json")
                      .then(res => res.json())
                      .then(data => callback(data.country_code))
                      .catch(() => callback("ca")); 
                },
                allowDropdown: false,
                formatOnDisplay: true,
                autoPlaceholder: 'aggressive',
                separateDialCode: true,
                utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
            });
            allFields.forEach(field => {
                const formGroup = field.closest('.form-group');
                field.addEventListener('focus', () => formGroup.classList.add('show-tooltip'));
                field.addEventListener('blur', () => formGroup.classList.remove('show-tooltip'));
            });
            const validateField = (field) => {
                const formGroup = field.closest('.form-group');
                let isValid = true;
                let errorText = '';
                formGroup.classList.remove('invalid');
                errorMessage.textContent = '';
                formContainer.classList.remove('invalid');
                if (field === emailField) {
                    isValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(field.value);
                    if (field.value && !isValid) errorText = 'Your email is incomplete.';
                } else if (field === nameField) {
                    isValid = field.value.trim() !== '';
                    if (!isValid && document.activeElement !== field) errorText = 'Please enter your full name.';
                } else if (field === phoneInputField) {
                    isValid = phoneInput.isValidNumber();
                    if (field.value && !isValid) errorText = 'Please enter a valid phone number.';
                }
                if (!isValid && errorText) {
                    formContainer.classList.add('invalid');
                    formGroup.classList.add('invalid');
                    errorMessage.textContent = errorText;
                }
                return isValid;
            };
            allFields.forEach(field => {
                field.addEventListener('blur', () => validateField(field));
            });
            form.addEventListener('submit', function(event) {
                event.preventDefault();
                const isFormValid = allFields.map(field => validateField(field)).every(status => status === true);
                if (!isFormValid) {
                    console.log("Form is invalid. Please check the fields.");
                    return;
                }
                const email = emailField.value;
                const phoneNumber = phoneInput.getNumber();
                const stripeUrl = `https://buy.stripe.com/aFa6oGch368X6py6sR0Ba01?locked_prefilled_email=${email}&utm_source=${email}&locale=en`;
                window.location.href = stripeUrl;
            });
        });
    </script>
</body>
</html>
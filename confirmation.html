<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confirmation de Paiement</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f6f9fc; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; color: #525f7f; }
        #loader-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #f6f9fc; display: flex; justify-content: center; align-items: center; z-index: 1000; transition: opacity 0.5s ease-out; }
        .spinner { width: 50px; height: 50px; border: 5px solid #e6ebf1; border-top: 5px solid #000000; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .container { display: flex; width: 100%; max-width: 900px; background-color: #ffffff; border-radius: 8px; box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11), 0 1px 3px rgba(0, 0, 0, 0.08); overflow: hidden; opacity: 0; transition: opacity 0.5s ease-in; }
        .panel { padding: 40px; flex: 1; }
        .panel-left { background-color: #ffffff; border-right: 1px solid #e6ebf1; }
        .panel-left h2 { font-size: 18px; font-weight: 500; color: #32325d; margin-top: 0; }
        .panel-left .amount { font-size: 32px; font-weight: 600; color: #32325d; margin: 10px 0; }
        .panel-left .description { font-size: 15px; line-height: 1.5; }
        .panel-right { display: flex; flex-direction: column; align-items: center; text-align: center; }
        .success-icon { width: 72px; height: 72px; border-radius: 50%; display: flex; justify-content: center; align-items: center; background-color: #f0fdf4; border: 1px solid #bbf7d0; margin-bottom: 24px; }
        .success-icon svg { width: 36px; height: 36px; color: #22c55e; }
        .panel-right h1 { font-size: 24px; font-weight: 600; color: #32325d; margin: 0 0 8px 0; }
        .panel-right p { font-size: 15px; margin-top: 0; max-width: 350px; }
        .transaction-details { width: 100%; background-color: #f6f9fc; border: 1px solid #e6ebf1; border-radius: 6px; padding: 16px; margin-top: 24px; font-size: 15px; display: flex; justify-content: space-between; align-items: center; color: #32325d; }
        .transaction-details .label { font-weight: 500; }
        .transaction-details .value { font-weight: 600; }
        .booking-number { margin-top: 20px; font-size: 16px; color: #32325d; }
        .booking-number span { font-weight: 600; background-color: #e6ebf1; padding: 4px 8px; border-radius: 4px; }
        .footer { margin-top: auto; padding-top: 32px; font-size: 13px; }
        .footer a { color: #6b7c93; text-decoration: none; margin: 0 8px; }
        .footer a:hover { text-decoration: underline; }
        @media (max-width: 768px) { .container { flex-direction: column; } .panel-left { border-right: none; border-bottom: 1px solid #e6ebf1; } }
    </style>
</head>
<body>

    <div id="loader-overlay">
        <div class="spinner"></div>
    </div>
    <div class="container">
        <div class="panel panel-left">
            <h2>Dépôt de sécurité</h2>
            <p class="amount">500,00 $ CA</p>
            <p class="description">
                Votre dépôt de sécurité vous sera remboursé 5 jours après votre séjour, suite à l'inspection du logement. 
            </p>
        </div>
        <div class="panel panel-right">
            <div class="success-icon">
                <svg fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"></path>
                </svg>
            </div>
            <h1>Merci pour votre dépôt!</h1>
            <p>Nous avons bien reçu votre dépôt de garantie! Vous allez recevoir un email de confirmation.</p>
            <p>Vous allez voir ceci sur votre relevé bancaire:</p>
            <img src="checkout.png" alt="bank" width="326" height="87">
        </div>
    </div>

    <script>
        window.onload = function() {
            const loader = document.getElementById('loader-overlay');
            const container = document.querySelector('.container');
            
            setTimeout(() => {
                if (loader) loader.style.opacity = '0';
                if (container) container.style.opacity = '1';
                setTimeout(() => { if (loader) loader.style.display = 'none'; }, 500);
            }, 500);

            const queryParams = new URLSearchParams(window.location.search);
            const email = queryParams.get('utm_source');

            const scriptUrl = 'https://script.google.com/macros/s/AKfycbxDbvhW_8WBxvwCqRyPu6quQyFQ25zdoWse-Si1M7kDdNIFZfAtABMUKwSyFtgmHvt0/exec'; 

            if (email && scriptUrl !== 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE') {
                const urlWithParams = scriptUrl + '?email=' + encodeURIComponent(email);

                fetch(urlWithParams)
                    .then(response => response.json())
                    .then(data => {
                        console.log('Email script response:', data);
                    })
                    .catch(error => {
                        console.error('Error sending confirmation email:', error);
                    });
            } else {
                if (!email) {
                    console.log('No "utm_source" parameter found in URL.');
                }
                if (scriptUrl === 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE') {
                    console.log('Please replace the placeholder with your Google Apps Script URL.');
                }
            }
        };
    </script>
</body>
</html>